# カルーセル実装計画書

## 1. 目的

「クライアントの声カルーセル 要件定義書」で定義された仕様に基づき、安定的かつ保守性の高い実装を実現するための技術的なアプローチと作業手順を計画する。

---

## 2. 技術選定

要件定義を満たすための実装アプローチとして、以下の2つの選択肢を比較検討する。

### 選択肢1: フルスクラッチ (CSS + JavaScript)

- **概要:** 外部ライブラリに頼らず、CSSとJavaScriptのみでカルーセルの全機能を実装する。
- **メリット:**
    - 外部ファイルへの依存がないため、読み込みがわずかに速い可能性がある。
- **デメリット:**
    - **複雑性の高さ:** 中央揃え、スケーリング、透明度、無限ループ、見切れ表現を同時に実現するロジックは非常に複雑になる。
    - **不安定さ:** これまでの試行で明らかなように、ブラウザや画面サイズによる微妙な計算のズレが発生しやすく、バグの温床となりやすい。
    - **開発コスト:** 安定した動作を実現するための開発・デバッグに多大な時間を要する。
    - **保守性の低さ:** コードが複雑になるため、将来の修正や機能追加が困難になる。

### 選択肢2: Swiper.js の利用 (強く推奨)

- **概要:** 高機能なカルーセルを実現するための、広く使われているJavaScriptライブラリ「Swiper.js」を導入する。
- **メリット:**
    - **安定性と信頼性:** 世界中の多くのウェブサイトで利用実績があり、非常に安定している。
    - **高機能:** 要件定義にある**ほぼ全ての機能（Coverflowエフェクト、中央揃え、無限ループ、ナビゲーションボタン、レスポンシブ対応など）が標準オプションとして提供されている。**
    - **開発コストの削減:** 複雑なロジックを自分で記述する必要がなく、オプションを設定するだけで済むため、迅速かつ確実に実装できる。
    - **保守性の高さ:** Swiper.jsのAPIに従うため、コードが標準化され、将来のメンテナンスが容易になる。
    - **スムーズなアニメーション:** パフォーマンスが最適化されており、滑らかなアニメーションを実現できる。
- **デメリット:**
    - **外部ライブラリの追加:** CDN経由でCSSとJSファイル（合計で約150KB程度）を読み込む必要があるが、現代のウェブ環境では大きな問題にはなりにくい。

### 結論

これまでの実装の難航を踏まえ、**品質、開発速度、将来の保守性の観点から、Swiper.jsの利用を強く推奨する。**
フルスクラッチでの実装は、さらなる問題の発生や手戻りのリスクが非常に高いと判断する。

---

## 3. 実装手順 (Swiper.jsを利用する場合)

1.  **Swiper.jsの読み込み:**
    - `index.html`の`<head>`タグ内に、Swiper.jsのCSSファイルのCDNリンクを追加する。
    - `</body>`タグの直前に、Swiper.jsのJavaScriptファイルのCDNリンクを追加する。

2.  **HTMLマークアップの変更:**
    - 「クライアントさまの声」セクションのHTMLを、Swiper.jsが要求する下記の構造に変更する。
    ```html
    <div class="swiper-container">
      <div class="swiper-wrapper">
        <!-- 各カードを .swiper-slide で囲む -->
        <div class="swiper-slide"><a href="..." class="voice-card">...</a></div>
        <div class="swiper-slide"><a href="..." class="voice-card">...</a></div>
        ...
      </div>
      <!-- ページネーションやナビゲーションボタンを配置 -->
      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
    </div>
    ```

3.  **JavaScriptの記述:**
    - 既存のカルーセル用スクリプトをすべて削除する。
    - 新たにSwiperのインスタンスを生成し、要件に合わせたオプションを設定する。
    ```javascript
    new Swiper('.swiper-container', {
      effect: 'coverflow', // 立体的なエフェクト
      grabCursor: true,
      centeredSlides: true,
      slidesPerView: 'auto', // 表示枚数を自動調整
      loop: true, // 無限ループ
      coverflowEffect: {
        rotate: 0,
        stretch: 80,  // カード間の距離
        depth: 200,   // 奥行きの深さ
        modifier: 1,  // エフェクトの倍率
        slideShadows: false,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
      initialSlide: 2, // 3番目のスライドを初期表示
    });
    ```

4.  **CSSの調整:**
    - Swiper.jsによって適用されるスタイルを、このウェブサイトのデザインテーマ（色、フォントなど）に合うように上書き・調整する。
    - 特に、ナビゲーションボタンのスタイルを現在のデザインに合わせる。

上記の手順で、安定かつ要件通りのカルーセルを実装できる見込み。
